# 卷积神经网络CNN	

CNN （Convolutional Neural Network）

## 处理的问题

卷积神经网络 – CNN 最擅长的就是图片的处理。它受到人类视觉神经系统的启发。

## 特点

+ 能够有效的将大数据量的图片降维成小数据量

+ 能够有效的保留图片特征，符合图片处理的原则

## 图像处理的难点

+ 图像需要处理的数据量太大，导致成本很高，效率很低

  - 图像的构成：

    - 图像由像素构成
    - 像素由颜色构成

    1000×1000 像素的图片，每个像素RGB三色各一个字节，因此参数为1000\*1000\*3=3000000,大约3M

+ 图像在数字化的过程中很难保留原有的特征，导致图像处理的准确率不高

  

## 如何解决

**把大量参数降维成少量参数，再做处理。****我们在大部分场景下，降维并不会影响结果。比如1000像素的图片缩小成200像素，并不影响肉眼认出来图片中是一只猫还是一只狗，机器也是如此。**

### 保留图像特征

![](https://easy-ai.oss-cn-shanghai.aliyuncs.com/2019-06-12-tuxiangtx.png)

假如有圆形是1，没有圆形是0，那么圆形的位置不同就会产生完全不同的数据表达。但是从视觉的角度来看，**图像的内容（本质）并没有发生变化，只是位置发生了变化**。

所以当我们移动图像中的物体，用传统的方式的得出来的参数会差异很大！这是不符合图像处理的要求的。

**他用类似视觉的方式保留了图像的特征，当图像做翻转，旋转或者变换位置时，它也能有效的识别出来是类似的图像。**

## 人类的视觉原理

人类的视觉原理如下：从原始信号摄入开始（瞳孔摄入像素 Pixels），接着做初步处理（大脑皮层某些细胞发现边缘和方向），然后抽象（大脑判定，眼前的物体的形状，是圆形的），然后进一步抽象（大脑进一步判定该物体是只气球）。下面是人脑进行人脸识别的一个示例：

对于不同的物体，人类视觉也是通过这样逐层分级，来进行认知的：

![](https://easy-ai.oss-cn-shanghai.aliyuncs.com/2019-06-19-renlei-shijue2.jpg)

我们可以看到，在最底层特征基本上是类似的，就是各种边缘，越往上，越能提取出此类物体的一些特征（轮子、眼睛、躯干等），到最上层，不同的高级特征最终组合成相应的图像，从而能够让人类准确的区分不同的物体。

那么我们可以很自然的想到：可以不可以模仿人类大脑的这个特点，构造多层的神经网络，较低层的识别初级的图像特征，若干底层特征组成更上一层特征，最终通过多个层级的组合，最终在顶层做出分类呢？

**答案是肯定的，这也是许多深度学习算法（包括CNN）的灵感来源。**

## 卷积神经网络-CNN 的基本原理

典型的 CNN 由3个部分构成：

1. 卷积层
2. 池化层
3. 全连接层

如果简单来描述的话：

卷积层负责提取图像中的局部特征；池化层用来大幅降低参数量级(降维)；全连接层类似传统神经网络的部分，用来输出想要的结果。

![](https://easy-ai.oss-cn-shanghai.aliyuncs.com/2019-06-24-cnnjiegou.png)

下面的原理解释为了通俗易懂，忽略了很多技术细节，如果大家对详细的原理感兴趣，可以看这个视频《[卷积神经网络基础](https://www.bilibili.com/video/av28733156/?p=3)》。

### 卷积——提取特征

卷积层的运算过程如下图，用一个卷积核扫完整张图片：

![](https://easy-ai.oss-cn-shanghai.aliyuncs.com/2019-06-19-juanji.gif)

这个过程我们可以理解为我们使用一个过滤器（卷积核）来过滤图像的各个小区域，从而得到这些小区域的特征值。

在具体应用中，往往有多个卷积核，可以认为，每个卷积核代表了一种图像模式，如果某个图像块与此卷积核卷积出的值大，则认为此图像块十分接近于此卷积核。如果我们设计了6个卷积核，可以理解：我们认为这个图像上有6种底层纹理模式，也就是我们用6中基础模式就能描绘出一副图像。以下就是25种不同的卷积核的示例：

![](https://easy-ai.oss-cn-shanghai.aliyuncs.com/2019-06-19-150926.jpg)

**总结：卷积层的通过卷积核的过滤提取出图片中局部的特征，跟上面提到的人类视觉的特征提取类似**

### 池化层（下采样）——数据降维，避免过拟合

池化层简单说就是下采样，他可以大大降低数据的维度。其过程如下：

![](https://easy-ai.oss-cn-shanghai.aliyuncs.com/2019-06-19-chihua.gif)

上图中，我们可以看到，原始图片是20×20的，我们对其进行**下采样**，采样窗口为10×10，最终将其下采样成为一个2×2大小的特征图。之所以这么做的原因，是因为即使做完了卷积，图像仍然很大（因为卷积核比较小），所以为了降低数据维度，就进行下采样。

**总结：池化层相比卷积层可以更有效的降低数据维度，这么做不但可以大大减少运算量，还可以有效的避免过拟合(避免对样本数的过渡精准，反而失去泛化能力)。**

## CNN 有哪些实际应用？

卷积神经网络 – CNN 很擅长处理图像。而视频是图像的叠加，所以同样擅长处理视频内容。下面给大家列一些比较成熟的应用：

**图像分类、检索**

图像分类是比较基础的应用，他可以节省大量的人工成本，将图像进行有效的分类。对于一些特定领域的图片，分类的准确率可以达到 95%+，已经算是一个可用性很高的应用了。

典型场景：图像搜索…

**目标定位检测**

可以在图像中定位目标，并确定目标的位置及大小。

典型场景：自动驾驶、安防、医疗…

**人脸识别**

人脸识别已经是一个非常普及的应用了，在很多领域都有广泛的应用。

典型场景：安防、金融、生活…

## 总结

今天我们介绍了 CNN 的价值、基本原理和应用场景，简单总结如下：

**CNN 的价值：**

1. 能够将大数据量的图片有效的降维成小数据量(并不影响结果)
2. 能够保留图片的特征，类似人类的视觉原理

**CNN 的基本原理：**

1. 卷积层 – 主要作用是保留图片的特征
2. 池化层 – 主要作用是把数据降维，可以有效的避免过拟合
3. 全连接层 – 根据不同任务输出我们想要的结果

**CNN 的实际应用：**

1. 图片分类、检索
2. 目标定位检测
3. 目标分割
4. 人脸识别
5. 骨骼识别